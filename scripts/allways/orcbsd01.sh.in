#!/bin/sh

if test -z "$JMARECEIPT_ENV"; then
    JMARECEIPT_ENV="@jma-receipt-env@"
fi
if ! test -f "$JMARECEIPT_ENV"; then
    exit 0
fi

. $JMARECEIPT_ENV

#-------------------------------------------#
#    データチェク処理
#        $1-${11} 印刷ＤＢ用固定引数
#        ${12} ジョブＩＤ
#        ${13} シェルＩＤ
#        ${14} 医療機関ＩＤ 
#        ${15} エラーファイル名 
#        ${16} 診療年月
#        ${17} 入外区分
#        ${18} チェック区分×５０
#        ${19} 社保の処理区分
#        ${20} 国保の処理区分
#        ${21} 労災の処理区分
#        ${22} 自賠責の処理区分
#        ${23} 自費保険の処理区分
#        ${24} 院外処方の処理区分
#        ${25} 印刷順
#        ${26} 患者別リストの作成区分
#-------------------------------------------#
##      エラーファイル削除
        if  [ -e ${15} ]; then
            rm  ${15}
        fi

	$DBSTUB -dir $LDDIRECTORY -bd orcabt ORCDTCHK000 -parameter "$1,$2,$3,$4,$5,$6,$7,$8,$9,${10},${11},${12},${13},${14},${15},${16},${17},${18},${19},${20},${21},${22},${23},${24},${25},${26},"
    if  [ -e ${15} ]; then
        exit
    fi

	$DBSTUB -dir $LDDIRECTORY -bd orcabt ORCBJOB -parameter JBE${12}${13}

##      作業ファイル削除
tmpf="/var/tmp/DTCHK"*"$9"
tmpf="$tmpf /var/tmp/DCACCT"*"$9"
tmpf="$tmpf /var/tmp/DCSRY"*"$9"

for f in $tmpf
do
	if  [ -e $f ]; then
		rm  $f
	fi
done

exit
