#!/bin/sh

if test -z "$JMARECEIPT_ENV"; then
    JMARECEIPT_ENV="@jma-receipt-env@"
fi
if ! test -f "$JMARECEIPT_ENV"; then
    exit 0
fi

. $JMARECEIPT_ENV

#-------------------------------------------#
#    データチェク処理
#        $1-${11} 印刷ＤＢ用固定引数
#        ${12} ジョブＩＤ
#        ${13} シェルＩＤ
#        ${14} 医療機関ＩＤ 
#        ${15} エラーファイル名 
#        ${16} 診療年月
#        ${17} 入外区分
#        ${18} チェック区分×５０
#        ${19} 自費保険者の処理区分
#        ${20} 院外処方の処理区分
#-------------------------------------------#
##      エラーファイル削除
        if  [ -e ${15} ]; then
            rm  ${15}
        fi


	$DBSTUB -dir "$LDDEFDIR"/directory -bd orcabt ORCDTCHK001 -parameter $1,$2,$3,$4,$5,$6,$7,$8,$9,${10},${11},${12},${13},${14},${15},${16},${17},${18},${19},${20},
    if  [ -e ${15} ]; then
        exit
    fi

	$DBSTUB -dir "$LDDEFDIR"/directory -bd orcabt ORCDTCHK002 -parameter $1,$2,$3,$4,$5,$6,$7,$8,$9,${10},${11},${12},${13},${14},${15},${16},${17},${18},${19},${20},
    if  [ -e ${15} ]; then
        exit
    fi

	$DBSTUB -dir "$LDDEFDIR"/directory -bd orcabt ORCDTCHK003 -parameter $1,$2,$3,$4,$5,$6,$7,$8,$9,${10},${11},${12},${13},${14},${15},${16},${17},${18},${19},${20},
    if  [ -e ${15} ]; then
        exit
    fi

	$DBSTUB -dir "$LDDEFDIR"/directory -bd orcabt ORCBJOB -parameter JBE${12}${13}

##      作業ファイル削除
tmpf="/var/tmp/DTCHK"*"$9"

	for f in $tmpf
	do
		if  [ -e $f ]; then
			rm  $f
		fi
	done

exit
