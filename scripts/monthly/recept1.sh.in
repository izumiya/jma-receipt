#!/bin/sh

if test -z "$JMARECEIPT_ENV" ; then
    JMARECEIPT_ENV="@jma-receipt-env@"
fi
if ! test -f "$JMARECEIPT_ENV"; then
    exit 0
fi

. $JMARECEIPT_ENV

#-------------------------------------------#
#    医療請求書用ファイル作成
#        ２００３年４月改正対応
#        
#        一括処理のとき２００３年４月以降のとき
#
#        CPCOMMONSHELL1.INC  
#        $1  SRYYM TERID SYSYMD
#        $2  SYOKBN
#            1:一括作成  2:個別作成
#        $3  RECEKBN
#            0:全体  1:社保　2:国保
#        $4  エラーファイル名 
#        $5  JOBID 
#        $6  SHELLID
#        $7  県単用項目編集プログラム名
#        $8  処理年月
#        $9  作成年月日
#        $10 作成時間
#        $11 県番号（個別作成のときは"00"）
#        $12 社保レセ電出力区分
#        $13 国保レセ電出力区分
#        $14 県区分（個別作成のとき山形、福岡のみ設定）
#-------------------------------------------#
##      エラーファイル削除
	echo $#
	echo "echo " $4
        if  [ -e $4 ]; then
            rm  $4
        fi
        
        rm  /var/tmp/RECE0*
        rm  /var/tmp/RECE11*
        
	    $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0010 -parameter $1$2$3$5$6 > /home/orca/recept1.log
	
        if  [ -e $4 ]; then
            exit  
        else 
	        $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0020 -parameter $1$3$5$6 >> /home/orca/recept1.log
        fi 

        if  [ -e $4 ]; then
            exit 
        else 
	        $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0030 -parameter $1$5$6 >> /home/orca/recept1.log

        fi
 
        if  [ -e $4 ]; then
            exit 
        else 
	        $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0035 -parameter $1$5$6 >> /home/orca/recept1.log
        fi
 
        if  [ -e $4 ]; then
            exit 
        else 
	        $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0038 -parameter $1$5$6 >> /home/orca/recept1.log
        fi

        if  [ -e $4 ]; then
            exit 
        else 
	        $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0040 -parameter $1$5$6 >> /home/orca/recept1.log
        fi
 
        if  [ -e $4 ]; then
            exit 
        else 
	        $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0050 -parameter $1$5$6 >> /home/orca/recept1.log
        fi

        if  [ -e $4 ]; then
            exit 
        else 
	        $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0055 -parameter $1$5$6 >> /home/orca/recept1.log
        fi
 
        if  [ -e $4 ]; then
            exit 
        else 
	        $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0090 -parameter $1$5$6 >> /home/orca/recept1.log
        fi
 
        if  [ -e $4 ]; then
            exit 
        else 
	        $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0091 -parameter $1$5$6 >> /home/orca/recept1.log
        fi
 
        if  [ -e $4 ]; then
            exit 
        else 
           if  [ $7 != "NOPG" ]; then
	         $DBSTUB -dir $LDDIRECTORY -bd recept $7 -parameter $1$5$6 >> /home/orca/recept1.log
	       fi
        fi

        if  [ -e $4 ]; then
            exit 
        else 
            if  [ $8 -lt '200210' ]; then
	            $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0100 -parameter $1$3$8$5$6 >> /home/orca/recept1.log
            else 
                if  [ $2 -eq '1' ]; then
##
##                  レセ一括作成 
                    if  [ $8 -lt '200304' ]; then
	                    $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0103 -parameter $9${10}$1$3$8$5$6 >> /home/orca/recept1.log
                    else 
	                    $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0104 -parameter $9${10}$1$2$3$8$5$6 >> /home/orca/recept1.log
                        if  [ -e $4 ]; then
                            exit 
                        else
                            if  [ ${11} -eq '06' ]; then
	                            $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCRCP060 -parameter $9${10}$1$2$3$8$5$6 >> /home/orca/recept1.log
                            fi
                            if  [ ${11} -eq '40' ]; then
	                            $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCRCP400 -parameter $9${10}$1$2$3$8$5$6 >> /home/orca/recept1.log
                            fi
	                    fi
                    fi
                else
##
##                  レセ個別作成 
	                $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0103 -parameter $9${10}$1$3$8$5$6 >> /home/orca/recept1.log
                    if  [ -e $4 ]; then
                        exit 
                    else
	                    $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0104 -parameter $9${10}$1$2$3$8$5$6 >> /home/orca/recept1.log
	                fi
                    if  [ -e $4 ]; then
                        exit 
                    else
                        if  [ ${14} -eq '06' ]; then
	                        $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCRCP060 -parameter $9${10}$1$2$3$8$5$6 >> /home/orca/recept1.log
                        fi
                        if  [ ${14} -eq '40' ]; then
	                        $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCRCP400 -parameter $9${10}$1$2$3$8$5$6 >> /home/orca/recept1.log
                        fi
                    fi
                fi
            fi  
        fi
##
##レセ電作成        
        if  [ -e $4 ]; then
            exit 
        else
            if  ( [ ${12} -eq '1' ] || [ ${12} -eq '3' ] ) && [ ${3} != '2' ]; then
                $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0200 -parameter $1,1,$5,$6 >> /home/orca/recept1.log
                if  [ -e $4 ]; then
                    exit 
                else
                    $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0210 -parameter $1,1,$5,$6 >> /home/orca/recept1.log
                fi
                if  [ -e $4 ]; then
                    exit 
                else
                    $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0300 -parameter $1,1,$5,$6 >> /home/orca/recept1.log
                fi
            fi
        fi

        if  [ -e $4 ]; then
            exit 
        else
            if  ( [ ${13} -eq '1' ] || [ ${13} -eq '3' ] ) && [ ${3} != '1' ]; then
                $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0200 -parameter $1,2,$5,$6 >> /home/orca/recept1.log
                if  [ -e $4 ]; then
                    exit 
                else
                    $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0210 -parameter $1,2,$5,$6 >> /home/orca/recept1.log
                fi
                if  [ -e $4 ]; then
                    exit 
                else
                    $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCR0300 -parameter $1,2,$5,$6 >> /home/orca/recept1.log
                fi
            fi
        fi
        
        if  [ -e $4 ]; then
            exit 
        else
	        $DBSTUB -dir $LDDIRECTORY -bd orcabt ORCBJOB -parameter JBE$5$6 >> /home/orca/recept1.log
	    fi
	
        exit 
