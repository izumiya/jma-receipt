#!/bin/sh

DBSYNC="false"
usage(){
    echo "usage: $0 [-dnsh] [--dbgroup][--noinstall][--dbsync][--help]" >&2
    exit 1
}

GETOPT=`getopt -o dnsh -l dbgroup,noinstall,dbsync,help -- "$@"`
if [ "$?" -ne 0 ] ; then
    usage
fi

eval set -- "$GETOPT"
while true
do
    case $1 in
	-d|--dbgroup) @bindir@/create_dbgroup.sh ; shift
	    ;;
	-n|--noinstall) SETUPOPT="$SETUPOPT --noinstall" ; shift
	    ;;
	-s|--dbsync) DBSYNC="true" ; shift
	    ;;
	-h|--help) usage
	    ;;
	--)
	    shift ; break
	    ;;
	*)
	    exit 2
	    ;;
    esac
done

@bindir@/jma-receipt-db-setup.sh -y $SETUPOPT
if [ "$?" -eq 0 ] ; then
    if [ "$DBSYNC" = "true" ] ; then
	echo "@bindir@/jma-dbsync.sh ...."
	@bindir@/jma-dbsync.sh
	if [ "$?" -eq 0 ] ; then
	    echo "done."
	fi
    fi
fi